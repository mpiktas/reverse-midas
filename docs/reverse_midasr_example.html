<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Reverse MIDAS with midasr</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="reverse_midasr_example_files/libs/clipboard/clipboard.min.js"></script>
<script src="reverse_midasr_example_files/libs/quarto-html/quarto.js"></script>
<script src="reverse_midasr_example_files/libs/quarto-html/popper.min.js"></script>
<script src="reverse_midasr_example_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="reverse_midasr_example_files/libs/quarto-html/anchor.min.js"></script>
<link href="reverse_midasr_example_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="reverse_midasr_example_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="reverse_midasr_example_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="reverse_midasr_example_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="reverse_midasr_example_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Reverse MIDAS with midasr</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>This document presents example of fitting RU-MIDAS and RR-MIDAS models as described in <a href="https://doi.org/10.1080/03610918.2018.1563148">Xu et al (2018)</a> and <a href="https://doi.org/10.1016/j.ijforecast.2018.06.004">Foroni et al (2018)</a> using <a href="https://cran.r-project.org/package=midasr">midasr</a> R package. The source code for this document can be found in this <a href="https://github.com/mpiktas/reverse-midas">repository</a>.</p>
<p>The RU-MIDAS and RR-MIDAS models are used to forecast high frequency variable using low frequency variable. Suppose <span class="math inline">\(y_t\)</span>, <span class="math inline">\(t\in \mathbb{Z}\)</span> is a univariate process observed at low frequency. Suppose <span class="math inline">\(x_\tau\)</span>, <span class="math inline">\(\tau=0,..,\)</span> is a high frequency variable, i.e.&nbsp;for each low frequency period <span class="math inline">\(t=t_0\)</span> we observe the variable <span class="math inline">\(x_\tau\)</span> is observed at <span class="math inline">\(m\)</span> high frequency periods: <span class="math inline">\(\tau = (t_0-1)m+1, ..., t_0m\)</span>.</p>
<p>The model specification is the following:</p>
<p><span class="math display">\[
x_{tm+h} = \mu+\sum_{j=0}^{p_Y}\mu_jy_{t-j}+\sum_{j=0}^{p_X}\beta_{j}x_{tm-j}+\varepsilon_{t}
\]</span></p>
</section>
<section id="forecasting-inflation-using-gdp-growth" class="level2">
<h2 class="anchored" data-anchor-id="forecasting-inflation-using-gdp-growth">Forecasting inflation using GDP growth</h2>
<p>For demonstration we will use quarterly US GDP and monthly US inflation. We fix the end dates, so that this document would reproduce the same results when newer data points appear in future.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(midasr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quantmod)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>usqgdp <span class="ot">&lt;-</span>  <span class="fu">getSymbols</span>(<span class="st">"GDP"</span>,<span class="at">src=</span><span class="st">"FRED"</span>,<span class="at">auto.assign=</span><span class="cn">FALSE</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>infl <span class="ot">&lt;-</span> <span class="fu">getSymbols</span>(<span class="st">"CPALTT01USM659N"</span>,<span class="at">src=</span><span class="st">"FRED"</span>,<span class="at">auto.assign=</span><span class="cn">FALSE</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>usqgdp <span class="ot">&lt;-</span> usqgdp[<span class="st">"/2022-04-01"</span>,]</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>infl <span class="ot">&lt;-</span> infl[<span class="st">"/2022-06-01"</span>]</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>gdpg <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>(usqgdp))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We are fitting a model which forecasts the inflation of the first month of the quarter using previous quarter GDP growth. The frequency aligning is done using function <code>mlsd</code>, which uses date information available from <code>gdpg</code> and <code>infl</code>. These two variables are <code>xts</code> objects.</p>
<p>In our case for the model specification we have <span class="math inline">\(h=1\)</span>, <span class="math inline">\(p_Y = 3\)</span> and <span class="math inline">\(p_X = 8\)</span>. This means that we are using 3 previous quarters of GDP growth and 9 months of inflation data.</p>
<p>The package midasr uses convention that the low frequency variable is observed at the end of the low frequency period, so the high frequency values at the current low frequency period are always lagged. The first month of the quarter is then 2 high frequency lags “behind”.</p>
<p>All model specifications in midasr package assumes that the left hand side variable is observed at the low frequency period <span class="math inline">\(t\)</span>. For <span class="math inline">\(h=1\)</span> the left hand side is observed at low frequency period <span class="math inline">\(t+1\)</span>, so to specify the model in midasr package we need to lag all the variables by one low frequency period, or 3 high frequency periods (one quarter is equal to 3 months).</p>
<p>Finally we arrive to the following specification:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mr <span class="ot">&lt;-</span> <span class="fu">midas_r</span>(<span class="fu">mlsd</span>(infl,<span class="dv">2</span>,gdpg)<span class="sc">~</span><span class="fu">mlsd</span>(gdpg, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, gdpg)<span class="sc">+</span><span class="fu">mlsd</span>(infl,<span class="dv">3</span><span class="sc">+</span><span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>, gdpg), <span class="at">data=</span><span class="fu">list</span>(<span class="at">gdpg=</span>gdpg, <span class="at">infl=</span>infl), <span class="at">start =</span> <span class="cn">NULL</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>mr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
MIDAS regression model with "numeric" data:
Start = 56, End = 302
 model: mlsd(infl, 2, gdpg) ~ mlsd(gdpg, 1:3, gdpg) + mlsd(infl, 3 +      0:8, gdpg) 
(Intercept)       gdpg1       gdpg2       gdpg3       infl1       infl2 
   -0.03919     0.02315     0.03041     0.06282     1.27659    -0.27883 
      infl3       infl4       infl5       infl6       infl7       infl8 
   -0.19871     0.22796    -0.02450    -0.09063     0.22257    -0.13683 
      infl9 
   -0.03304 

Function lm was used for fitting</code></pre>
</div>
</div>
<p>Let us inspect what time series form the part of the model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>mr<span class="sc">$</span>model[<span class="fu">nrow</span>(mr<span class="sc">$</span>model)<span class="sc">-</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">0</span>), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           y (Intercept) mlsd(gdpg, 1:3, gdpg)X.1 mlsd(gdpg, 1:3, gdpg)X.2
300 5.365475           1                 3.138917                 2.576810
301 6.221869           1                 2.008565                 3.138917
302 7.479872           1                 3.391781                 2.008565
303 8.258629           1                 1.586818                 3.391781
    mlsd(gdpg, 1:3, gdpg)X.3 mlsd(infl, 3 + 0:8, gdpg)X.3
300                 1.591087                     5.391451
301                 2.576810                     5.390349
302                 3.138917                     7.036403
303                 2.008565                     8.542456
    mlsd(infl, 3 + 0:8, gdpg)X.4 mlsd(infl, 3 + 0:8, gdpg)X.5
300                     4.992707                     4.159695
301                     5.251272                     5.365475
302                     6.809003                     6.221869
303                     7.871064                     7.479872
    mlsd(infl, 3 + 0:8, gdpg)X.6 mlsd(infl, 3 + 0:8, gdpg)X.7
300                     2.619763                     1.676215
301                     5.391451                     4.992707
302                     5.390349                     5.251272
303                     7.036403                     6.809003
    mlsd(infl, 3 + 0:8, gdpg)X.8 mlsd(infl, 3 + 0:8, gdpg)X.9
300                     1.399770                     1.362005
301                     4.159695                     2.619763
302                     5.365475                     5.391451
303                     6.221869                     5.390349
    mlsd(infl, 3 + 0:8, gdpg)X.10 mlsd(infl, 3 + 0:8, gdpg)X.11
300                      1.174536                      1.182066
301                      1.676215                      1.399770
302                      4.992707                      4.159695
303                      5.251272                      5.365475</code></pre>
</div>
</div>
<p>Let us inspect the last months of data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>infl[<span class="st">"2021-10-01/"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           CPALTT01USM659N
2021-10-01        6.221869
2021-11-01        6.809003
2021-12-01        7.036403
2022-01-01        7.479872
2022-02-01        7.871064
2022-03-01        8.542456
2022-04-01        8.258629
2022-05-01        8.581512
2022-06-01        9.059758</code></pre>
</div>
</div>
<p>Compare it with the first column of the model matrix and you will see that the values in column <code>y</code> correspond to the values of first month of the quarter, namely the last row contains value for March of 2022, the previous value corresponds to January of 2022 and so on. These values are regressed against previous 12 months of inflation.</p>
<p>Here is the low frequency variable</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>gdpg[<span class="st">"2021-01-01/"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                GDP
2021-01-01 2.576810
2021-04-01 3.138917
2021-07-01 2.008565
2021-10-01 3.391781
2022-01-01 1.586818
2022-04-01 1.889125</code></pre>
</div>
</div>
<p>You can see that the values in the last row of the columns <code>mlsd(gdpg, 1:3, gdpg)X.1</code> to <code>mlsd(gdpg, 1:3, gdpg)X.3</code> correspond to yearly GDP growth for first quarter of 2022 and the last two quarters of 2021.</p>
<p>Let us inspect model we fit</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
MIDAS regression model with "numeric" data:
Start = 56, End = 302

 Formula mlsd(infl, 2, gdpg) ~ mlsd(gdpg, 1:3, gdpg) + mlsd(infl, 3 +      0:8, gdpg) 

 Parameters:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.03919    0.04991  -0.785  0.43308    
gdpg1        0.02315    0.01616   1.432  0.15338    
gdpg2        0.03041    0.01727   1.761  0.07951 .  
gdpg3        0.06282    0.01817   3.456  0.00065 ***
infl1        1.27659    0.07816  16.333  &lt; 2e-16 ***
infl2       -0.27883    0.11661  -2.391  0.01759 *  
infl3       -0.19871    0.11981  -1.658  0.09856 .  
infl4        0.22796    0.11822   1.928  0.05502 .  
infl5       -0.02450    0.13221  -0.185  0.85315    
infl6       -0.09063    0.10396  -0.872  0.38424    
infl7        0.22257    0.10415   2.137  0.03364 *  
infl8       -0.13683    0.12482  -1.096  0.27411    
infl9       -0.03304    0.06691  -0.494  0.62196    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

 Residual standard error: 0.352 on 234 degrees of freedom</code></pre>
</div>
</div>
<p>The model suggests that the lags of GDP can be useful in forecasting the inflation.</p>
<p>We can try to impose some lag structure on the monthly data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>mr1 <span class="ot">&lt;-</span> <span class="fu">midas_r</span>(<span class="fu">mlsd</span>(infl,<span class="dv">2</span>,gdpg)<span class="sc">~</span><span class="fu">mlsd</span>(gdpg, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, gdpg)<span class="sc">+</span><span class="fu">mlsd</span>(infl,<span class="dv">3</span><span class="sc">+</span><span class="dv">0</span><span class="sc">:</span><span class="dv">11</span>, gdpg,nealmon), <span class="at">data=</span><span class="fu">list</span>(<span class="at">gdpg=</span>gdpg, <span class="at">infl=</span>infl), <span class="at">start =</span> <span class="fu">list</span>(<span class="at">infl =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>)), <span class="at">method =</span> <span class="st">"Nelder-Mead"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>mr2 <span class="ot">&lt;-</span> <span class="fu">update</span>(mr1, <span class="at">method =</span> <span class="st">"BFGS"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>mr2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
MIDAS regression model with "numeric" data:
Start = 57, End = 302
 model: mlsd(infl, 2, gdpg) ~ mlsd(gdpg, 1:3, gdpg) + mlsd(infl, 3 +      0:11, gdpg, nealmon) 
(Intercept)       gdpg1       gdpg2       gdpg3       infl1       infl2 
   -0.07238     0.01536     0.04268     0.06299     0.97211    -8.76726 

Function optim was used for fitting</code></pre>
</div>
</div>
<p>Let us inspect the fit</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mr2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
MIDAS regression model with "numeric" data:
Start = 57, End = 302

 Formula mlsd(infl, 2, gdpg) ~ mlsd(gdpg, 1:3, gdpg) + mlsd(infl, 3 +      0:11, gdpg, nealmon) 

 Parameters:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -0.07238    0.05187  -1.395   0.1642    
gdpg1         0.01536    0.01785   0.861   0.3904    
gdpg2         0.04268    0.01729   2.469   0.0142 *  
gdpg3         0.06299    0.02093   3.009   0.0029 ** 
infl1         0.97211    0.01146  84.844   &lt;2e-16 ***
infl2        -8.76726  603.10547  -0.015   0.9884    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

 Residual standard error: 0.3758 on 240 degrees of freedom</code></pre>
</div>
</div>
<p>The fit is slightly worse because the restriction is not very good. As can be seen from the coefficients:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_midas_coef</span>(mr2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="reverse_midasr_example_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="frequency-aliging-with-mls" class="level2">
<h2 class="anchored" data-anchor-id="frequency-aliging-with-mls">Frequency aliging with mls</h2>
<p>We can align frequencies manually. For that we need to align the start and beginning of the times series and padd high frequency data with NAs. The inflation data ends at June, 2022. The gdp data ends at second quarter of 2022. So in this case we have a full quarter of the high frequency data, which means that no padding is necessary.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>infl1 <span class="ot">&lt;-</span> infl[<span class="st">"1960-01-01/2022-06-01"</span>]</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>gdpgp1 <span class="ot">&lt;-</span> gdpg[<span class="st">"1960-01-01/2022-04-01"</span>]</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>infl2 <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">c</span>(<span class="fu">as.numeric</span>(infl1)), <span class="at">start=</span><span class="fu">c</span>(<span class="dv">1960</span>,<span class="dv">1</span>), <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>gdpg2 <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">as.numeric</span>(gdpgp1), <span class="at">start=</span><span class="fu">c</span>(<span class="dv">1960</span>,<span class="dv">1</span>), <span class="at">frequency =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us fit the same model with aligned data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>mra <span class="ot">&lt;-</span> <span class="fu">midas_r</span>(<span class="fu">mls</span>(infl,<span class="dv">2</span>,<span class="dv">3</span>)<span class="sc">~</span><span class="fu">mls</span>(gdpg, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">1</span>)<span class="sc">+</span><span class="fu">mls</span>(infl,<span class="dv">3</span><span class="sc">+</span><span class="dv">0</span><span class="sc">:</span><span class="dv">11</span>, <span class="dv">3</span>), <span class="at">data=</span><span class="fu">list</span>(<span class="at">gdpg=</span>gdpg2, <span class="at">infl=</span>infl2), <span class="at">start =</span> <span class="cn">NULL</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>mra</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
MIDAS regression model with "numeric" data:
Start = 5, End = 250
 model: mls(infl, 2, 3) ~ mls(gdpg, 1:3, 1) + mls(infl, 3 + 0:11, 3) 
(Intercept)       gdpg1       gdpg2       gdpg3       infl1       infl2 
   -0.03025     0.02397     0.03639     0.04949     1.28237    -0.27839 
      infl3       infl4       infl5       infl6       infl7       infl8 
   -0.20976     0.24882    -0.04254    -0.07836     0.21885    -0.19394 
      infl9      infl10      infl11      infl12 
    0.13788    -0.03804    -0.15507     0.07258 

Function lm was used for fitting</code></pre>
</div>
</div>
<p>The model fit is the same. We can check that by comparing the coefficients:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">abs</span>(<span class="fu">coef</span>(mr)<span class="sc">-</span><span class="fu">coef</span>(mra)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in coef(mr) - coef(mra): longer object length is not a multiple of
shorter object length</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5507905</code></pre>
</div>
</div>
</section>
<section id="forecasting" class="level2">
<h2 class="anchored" data-anchor-id="forecasting">Forecasting</h2>
<p>Let us use the model for forecasting. First let us reestimate model with the data up to first quarter of the 2022.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>infl_h <span class="ot">&lt;-</span> infl[<span class="st">"/2022-03-01"</span>]</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>gdpg_h <span class="ot">&lt;-</span> gdpg[<span class="st">"/2022-01-01"</span>]</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>mrh <span class="ot">&lt;-</span> <span class="fu">update</span>(mr, <span class="at">data =</span> <span class="fu">list</span>(<span class="at">infl =</span> infl_h, <span class="at">gdpg =</span> gdpg_h))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Check whether the frequency aligning worked as expected:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>mrh<span class="sc">$</span>model[<span class="fu">nrow</span>(mrh<span class="sc">$</span>model),<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           y                  (Intercept) 
                    7.479872                     1.000000 
    mlsd(gdpg, 1:3, gdpg)X.1     mlsd(gdpg, 1:3, gdpg)X.2 
                    3.391781                     2.008565 
    mlsd(gdpg, 1:3, gdpg)X.3 mlsd(infl, 3 + 0:8, gdpg)X.3 
                    3.138917                     7.036403 </code></pre>
</div>
</div>
<p>To forecast the inflation value for April of 2022 (first month of the second quarter of 2022) we cannot use the <code>forecast</code> function of package midasr, because it currently does not support any transformations of left hand side variable. But we can use function <code>predict</code>, which simply fits the supplied right hand side data. So to get the forecast we pass the full data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">predict</span>(mrh, <span class="at">newdata =</span> <span class="fu">list</span>(<span class="at">gdpg =</span> gdpg, <span class="at">infl =</span> infl))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Since the full data has additional low frequency lag, the forecast will be the last predicted value. We can check that the predictions for historic data coincide with fitted values of the model. Let us check the last four predictions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(pr[<span class="fu">length</span>(pr)<span class="sc">-</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">1</span>)],mrh<span class="sc">$</span>fitted.values[<span class="fu">length</span>(mrh<span class="sc">$</span>fitted.values)<span class="sc">-</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">0</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1]     [,2]
[1,] 1.123523 1.123523
[2,] 3.451415 3.451415
[3,] 5.418586 5.418586
[4,] 5.667616 5.667616
[5,] 7.142025 7.142025</code></pre>
</div>
</div>
<p>We can compare the model forecast with the actual value</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(pr[<span class="fu">length</span>(pr)], infl[<span class="st">"2022-04-01/2022-04-01"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.648260 8.258629</code></pre>
</div>
</div>
<p>We can see that the model forecasted higher inflation.</p>
</section>
<section id="forecasting-full-quarter" class="level2">
<h2 class="anchored" data-anchor-id="forecasting-full-quarter">Forecasting full quarter</h2>
<p>To forecast other months we need to specify a model for each month. The only change is the left hand side variable. We will fit the models with the data with last quarter removed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>mrh_2 <span class="ot">&lt;-</span> <span class="fu">update</span>(mrh, <span class="at">formula =</span> <span class="fu">mlsd</span>(infl, <span class="dv">1</span>, gdpg)<span class="sc">~</span>.)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>mrh_3 <span class="ot">&lt;-</span> <span class="fu">update</span>(mrh, <span class="at">formula =</span> <span class="fu">mlsd</span>(infl, <span class="dv">0</span>, gdpg)<span class="sc">~</span>.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us inspect the last rows of the model matrices used to check that frequency alignment works as expected.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>mrh_2<span class="sc">$</span>model[<span class="fu">nrow</span>(mrh_2<span class="sc">$</span>model),<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           y                  (Intercept) 
                    7.871064                     1.000000 
    mlsd(gdpg, 1:3, gdpg)X.1     mlsd(gdpg, 1:3, gdpg)X.2 
                    3.391781                     2.008565 
    mlsd(gdpg, 1:3, gdpg)X.3 mlsd(infl, 3 + 0:8, gdpg)X.3 
                    3.138917                     7.036403 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>mrh_3<span class="sc">$</span>model[<span class="fu">nrow</span>(mrh_3<span class="sc">$</span>model),<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           y                  (Intercept) 
                    8.542456                     1.000000 
    mlsd(gdpg, 1:3, gdpg)X.1     mlsd(gdpg, 1:3, gdpg)X.2 
                    3.391781                     2.008565 
    mlsd(gdpg, 1:3, gdpg)X.3 mlsd(infl, 3 + 0:8, gdpg)X.3 
                    3.138917                     7.036403 </code></pre>
</div>
</div>
<p>The right hand side remains the same and the left hand side have values for the respective second and third months of the first quarter of 2022.</p>
<p>Let us forecast the full quarter and compare with the actual values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>pr2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mrh_2, <span class="at">newdata =</span> <span class="fu">list</span>(<span class="at">gdpg =</span> gdpg, <span class="at">infl =</span> infl))</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>pr3 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mrh_3, <span class="at">newdata =</span> <span class="fu">list</span>(<span class="at">gdpg =</span> gdpg, <span class="at">infl =</span> infl))</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>q2f <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">tail</span>(pr, <span class="at">n =</span> <span class="dv">1</span>), <span class="fu">tail</span>(pr2, <span class="at">n =</span> <span class="dv">1</span> ), <span class="fu">tail</span>(pr3, <span class="at">n =</span> <span class="dv">1</span>))</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(q2f, infl[<span class="st">"2022-04-01/2022-06-01"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                q2f CPALTT01USM659N
2022-04-01 8.648260        8.258629
2022-05-01 8.682332        8.581512
2022-06-01 8.595526        9.059758</code></pre>
</div>
</div>
</section>
<section id="forecasting-the-next-quarter" class="level2">
<h2 class="anchored" data-anchor-id="forecasting-the-next-quarter">Forecasting the next quarter</h2>
<p>Since the we use only the previous low frequency period in the specification we can forecast the inflation for the months for which we do not have the data, i.e.&nbsp;the months of July to September of 2022. To do that we only need to extend the historic data time series with NAs for the next quarter.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>infl_q3 <span class="ot">&lt;-</span> <span class="fu">xts</span>(<span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>), <span class="at">order.by =</span> <span class="fu">ymd</span>(<span class="st">"2022-07-01"</span>,<span class="st">"2022-08-01"</span>,<span class="st">"2022-09-01"</span>))</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>gdpg_q3 <span class="ot">&lt;-</span> <span class="fu">xts</span>(<span class="cn">NA</span>, <span class="at">order.by =</span> <span class="fu">ymd</span>(<span class="st">"2022-07-01"</span>))</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>infl_f1 <span class="ot">&lt;-</span> <span class="fu">c</span>(infl,infl_q3)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>gdpg_f1 <span class="ot">&lt;-</span> <span class="fu">c</span>(gdpg,gdpg_q3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us update the specifications with full historic data and then do the forecast.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>mrh_f2 <span class="ot">&lt;-</span> <span class="fu">update</span>(mrh_2, <span class="at">data =</span> <span class="fu">list</span>(<span class="at">infl =</span> infl, <span class="at">gdpg =</span> gdpg))</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>mrh_f3 <span class="ot">&lt;-</span> <span class="fu">update</span>(mrh_3, <span class="at">data =</span> <span class="fu">list</span>(<span class="at">infl =</span> infl, <span class="at">gdpg =</span> gdpg))</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>pr_jul <span class="ot">&lt;-</span> <span class="fu">predict</span>(mr, <span class="at">newdata =</span> <span class="fu">list</span>(<span class="at">infl =</span> infl_f1, <span class="at">gdpg =</span> gdpg_f1))</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>pr_aug <span class="ot">&lt;-</span> <span class="fu">predict</span>(mrh_f2, <span class="at">newdata =</span> <span class="fu">list</span>(<span class="at">infl =</span> infl_f1, <span class="at">gdpg =</span> gdpg_f1))</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>pr_sep <span class="ot">&lt;-</span> <span class="fu">predict</span>(mrh_f3, <span class="at">newdata =</span> <span class="fu">list</span>(<span class="at">infl =</span> infl_f1, <span class="at">gdpg =</span> gdpg_f1))</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>pr_q3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">tail</span>(pr_jul, <span class="at">n =</span> <span class="dv">1</span>), <span class="fu">tail</span>(pr_aug, <span class="at">n =</span> <span class="dv">1</span>), <span class="fu">tail</span>(pr_sep, <span class="at">n =</span> <span class="dv">1</span>))</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="fu">xts</span>(pr_q3, <span class="at">order.by =</span> <span class="fu">ymd</span>(<span class="fu">c</span>(<span class="st">"2022-07-01"</span>,<span class="st">"2022-08-01"</span>,<span class="st">"2022-09-01"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               [,1]
2022-07-01 9.303091
2022-08-01 9.360826
2022-09-01 9.343012</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>
